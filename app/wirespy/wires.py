# -*- coding: utf-8 -*-
"""
Created on Tue Dec  5 13:40:42 2017

@author: Shannon Glavin - sglavin@sas.upenn.edu (Python 3.4)

Description:
copied & working off of wire.py created by Jorge Chaves
newest change: making more user friendly
               some more options to toggle
               changed some variables to more intuitive names
               made shaded regions for individual track plots 3 times darker
               separated into separate files
"""

import matplotlib.pyplot as plt
import matplotlib.patches as patches
import numpy as np

import os,sys

import wires_constants as const
import wires_functions as func
import wires_toggle as tog

if tog.locallaptop == 0: import ROOT

###############################################################################
# main function
###############################################################################

def wiresMain(ew,lw,subevent,prefix):
    allmps_e = []       #list of all early midpoints
    allmps_l = []       #list of all late midpoints
    polyregion_all = [] #list of all polygon regions (as multiple lists of xy coords)
    triareas_all = []   #list of all triangular areas enclosed by wire (of each plane) associated with hit
    badevents = []      #list of subevents that don't meet the badarealimit
    progress = 0        #to show print out of how many tracks finished

    if tog.locallaptop == 0:
        h_angle = ROOT.TH1F("h_angle","",100,-3.15,3.15)
    else:
        h_angle = []
    
    for w_e,w_l,se in zip(ew,lw,subevent):
        wires_e = []    #list of wires associated with early hit
        wires_l = []    #list of wires associated with late hit
        
        if tog.plotEach == 1:
            #plot polygon
            fig1 = plt.figure()
            ax1 = fig1.add_subplot(111, aspect='equal')
            ax1.add_patch(
                patches.RegularPolygon(
                    (0, 0),      # (x,y)
                    6,           # number of vertices
                    const.radius,      # radius
                    fill = False
                )
            )
            ax1.set_xlim(-200,200)
            ax1.set_ylim(-200,200)
            if const.plotaxis == 1: func.plotAxis()
        
        #plot 3 wire planes
        for aa in range(3):
            coords = func.getWireCoords(aa, w_e)
            xx = coords[0]
            yy = coords[1]
            if tog.plotEach == 1:
                plt.plot(xx, yy, const.startcolor, ls='-')
                        
            wires_e.append([xx,yy])
            
            coords = func.getWireCoords(aa, w_l)
            xx = coords[0]
            yy = coords[1]
            if tog.plotEach == 1:
                plt.plot(xx, yy, const.endcolor, ls='-')

            wires_l.append([xx,yy])
        
        mp_e = func.getMidpoint(wires_e)
        mp_l = func.getMidpoint(wires_l)
             
        ints_e = func.getAllIntersections(wires_e)
        ints_l = func.getAllIntersections(wires_l)

        ints_all = func.combineAllPoints(ints_e, ints_l)
        ints_all = func.convex_hull(ints_all)
        ints_all = np.array(ints_all)
        
        triareas_all.append(func.PolygonArea(ints_e))
        triareas_all.append(func.PolygonArea(ints_l))
        
        if func.PolygonArea(ints_e) > tog.badarealimit or func.PolygonArea(ints_l) > tog.badarealimit:
            badevents.append(se)
        else:
            allmps_e.append(mp_e)
            allmps_l.append(mp_l)
            polyregion_all.append(ints_all)

        if tog.plotEach == 1:
            if tog.plt_shading == 1:
                ax1 = fig1.add_subplot(111, aspect='equal')
                ax1.add_patch(patches.Polygon(ints_all, color=const.midcolor, alpha=3*const.hotshading, lw=0))
                ax1.set_xlim(-200,200)
                ax1.set_ylim(-200,200)
                
            if tog.plt_dots == 1: func.plotMPs(mp_e, mp_l)

            if tog.locallaptop == 1:
                plt.savefig(prefix+str(se)+'.pdf', bbox_inches='tight')
            else:
                plt.savefig('plots/'+sys.argv[1].replace('.root','')+'/events/'+prefix+str(se)+'.pdf', bbox_inches='tight')
                plt.savefig('plots/'+sys.argv[1].replace('.root','')+'/events/'+prefix+str(se)+'.png', bbox_inches='tight')
            plt.close()

        if tog.showprogress == 1:
            if tog.plotEach == 1:
                if progress % 25 == 0: print(prefix + str(se) + ".pdf saved\t~ " + str(100*progress/len(subevent)) + "% done")
            else:
                if progress % 25 == 0: print("\t~ " + str(100*progress/len(subevent)) + "% done")
            progress = progress + 1
        
    func.plotAllRegions([allmps_e, allmps_l], polyregion_all, prefix)
    
    bb = 0
    for gmp_e,gmp_l in zip(allmps_e, allmps_l):
        ang = func.getTrackAngle(gmp_e,gmp_l)
        if ang != -666:
            if tog.locallaptop == 0:
                h_angle.Fill(ang)
            else:
                h_angle.append(ang)
        else:
            print("CHECK OUT: " + str(bb))
        bb = bb + 1

    if tog.locallaptop == 0:
        c1 = ROOT.TCanvas("c1","",900,600)
        h_angle.Draw()
        c1.Print('plots/'+sys.argv[1].replace('.root','')+'/'+'h_angle_'+prefix[:-1]+'.pdf')
        c1.Print('plots/'+sys.argv[1].replace('.root','')+'/'+'h_angle_'+prefix[:-1]+'.png')

    if tog.returnoption == 0:
        return polyregion_all
    elif tog.returnoption == 1:
        return triareas_all
    elif tog.returnoption == 2:
        return badevents
    else:
        return 0


###############################################################################
# data
###############################################################################


# [x,u,v]
ew_beam = []
lw_beam = []
subevent_beam = []

ew_cosmics = []
lw_cosmics = []
subevent_cosmics = []

if tog.locallaptop == 0:
    # Read from ROOT file
    if len(sys.argv) < 2:
        raise ValueError('Missing input file.')
        
    f = ROOT.TFile(sys.argv[1])
    t = ROOT.TTree()
    f.GetObject("tracks",t)
    os.system('mkdir -p plots/'+sys.argv[1].replace('.root','')+'/events')
    
    ev = 1
    for e in t:
        for i in xrange(0,e.nmatches):
            if e.beam[i] == 1:
                ew_beam.append([int(e.first_hit_X[i]),int(e.first_hit_U[i]),int(e.first_hit_V[i])])
                lw_beam.append([int(e.last_hit_X[i]),int(e.last_hit_U[i]),int(e.last_hit_V[i])])
                subev = '%d.%d' %(e.Event,i)
                subevent_beam.append(float(subev))
            elif e.beam[i] == 0:
                ew_cosmics.append([int(e.first_hit_X[i]),int(e.first_hit_U[i]),int(e.first_hit_V[i])])
                lw_cosmics.append([int(e.last_hit_X[i]),int(e.last_hit_U[i]),int(e.last_hit_V[i])])
                subev = '%d.%d' %(e.Event,i)
                subevent_cosmics.append(float(subev))
            else:
                print("uh oh... something is wrong")            
    
    print("\n\new_beam = ")
    print ew_beam
    print("\n\nlw_beam = ")
    print lw_beam
    print("\n\nsubevent_beam = ")
    print subevent_beam
    print("\n\new_cosmics = ")
    print ew_cosmics
    print("\n\nlw_cosmics = ")
    print lw_cosmics
    print("\n\nsubevent_cosmics = ")
    print subevent_cosmics
    print("\n\n\n")
    
else:
    ew_beam = [[281, 193, 260], [308, 288, 186], [157, 288, 186], [133, 160, 144], [177, 247, 96], [179, 81, 266], [273, 208, 217], [186, 249, 110], [59, 133, 86], [68, 22, 218], [133, 198, 77], [216, 239, 248], [26, 74, 115], [32, 92, 154], [205, 188, 187], [121, 151, 163], [249, 197, 208], [5, 88, 92], [222, 198, 194], [112, 26, 255], [314, 212, 144], [37, 91, 144], [193, 185, 183], [222, 145, 226], [39, 145, 1], [324, 145, 1], [171, 87, 250], [277, 182, 271], [268, 130, 0], [110, 130, 147], [84, 118, 132], [201, 168, 214], [292, 186, 274], [262, 96, 329], [245, 217, 228], [259, 182, 236], [200, 176, 193], [86, 208, 86], [122, 208, 86], [250, 185, 232], [257, 192, 232], [201, 156, 192], [205, 80, 295], [162, 112, 295], [306, 206, 266], [134, 167, 206], [205, 167, 206], [180, 154, 206], [220, 154, 206], [178, 128, 208], [165, 156, 190], [75, 189, 137], [261, 189, 137], [167, 179, 252], [171, 197, 96], [216, 163, 224], [126, 204, 96], [190, 197, 96], [261, 115, 309], [111, 43, 243], [94, 146, 171], [155, 146, 171], [249, 181, 236], [145, 1, 312], [201, 228, 326], [276, 184, 251], [90, 137, 238], [282, 168, 260], [211, 195, 246], [326, 195, 246], [67, 127, 105], [146, 152, 159], [276, 218, 240], [150, 135, 181], [135, 125, 179], [278, 168, 279], [327, 224, 301], [295, 136, 328], [212, 261, 123], [280, 215, 250], [81, 130, 126], [295, 146, 315], [259, 178, 212], [140, 206, 163], [128, 206, 163], [225, 92, 315], [218, 136, 244], [125, 95, 195], [237, 105, 208], [12, 105, 97], [108, 102, 173], [241, 102, 173], [295, 96, 307], [36, 96, 124], [11, 60, 140], [96, 245, 21], [143, 206, 106], [6, 174, 134], [124, 174, 134], [186, 156, 198], [160, 325, 96], [216, 169, 211], [57, 96, 211], [114, 175, 113], [180, 181, 167], [220, 132, 240], [218, 177, 203], [104, 136, 120], [185, 127, 225], [105, 110, 157], [27, 185, 23], [122, 175, 155], [104, 145, 124], [86, 124, 123], [116, 46, 237], [23, 53, 123], [222, 170, 217], [110, 273, 9], [159, 137, 223], [106, 168, 86], [325, 168, 277], [222, 168, 173], [205, 18, 115], [120, 197, 160], [269, 197, 264], [155, 114, 212], [268, 214, 230], [210, 155, 230], [301, 198, 273], [293, 204, 264], [283, 154, 285], [189, 176, 180], [195, 170, 191], [175, 275, 173], [283, 196, 252], [303, 0, 214], [183, 0, 214], [83, 92, 129], [183, 92, 129], [212, 172, 208], [271, 284, 154], [118, 96, 128], [185, 186, 128], [295, 186, 124], [262, 198, 209], [273, 196, 263], [249, 188, 230], [90, 115, 129], [326, 197, 282], [262, 204, 242], [235, 182, 179], [275, 171, 271], [242, 177, 230], [326, 204, 287], [135, 127, 177], [228, 175, 220], [60, 103, 124], [259, 138, 216], [205, 241, 216], [57, 107, 131], [225, 306, 83], [75, 220, 13], [241, 239, 169], [102, 198, 145], [326, 137, 248], [225, 282, 157], [276, 282, 157], [128, 218, 78], [257, 218, 78], [295, 184, 233], [178, 163, 186], [233, 168, 233], [278, 190, 248], [326, 206, 277], [116, 171, 192], [188, 118, 192], [94, 85, 174], [73, 96, 175], [327, 216, 175], [289, 196, 256], [78, 137, 144], [216, 318, 96], [295, 318, 259], [190, 169, 208], [120, 169, 208], [173, 221, 114], [155, 152, 174], [250, 171, 235], [190, 204, 206], [292, 204, 252], [89, 46, 204], [218, 151, 238], [313, 232, 250], [77, 2, 243], [133, 83, 216], [273, 169, 264], [167, 196, 138], [289, 197, 243], [157, 195, 238], [268, 195, 243], [313, 208, 318], [250, 184, 248], [10, 80, 97], [166, 141, 206], [250, 271, 153], [224, 179, 205], [95, 109, 138], [268, 112, 321], [228, 174, 325], [280, 174, 325], [3, 145, 21], [325, 226, 266], [202, 313, 50], [167, 145, 203], [257, 234, 188], [210, 181, 194], [75, 114, 129], [235, 175, 227], [94, 172, 92], [289, 194, 273], [243, 177, 230], [241, 163, 196], [42, 171, 37], [157, 171, 37], [218, 295, 107], [65, 112, 114], [142, 115, 218], [261, 187, 197], [29, 176, 0], [150, 68, 242], [235, 193, 211], [221, 60, 315], [282, 171, 37], [54, 171, 37], [180, 198, 144], [269, 204, 246], [326, 194, 300], [321, 214, 204], [245, 214, 204], [178, 167, 179], [304, 174, 293], [269, 112, 296], [128, 68, 224], [181, 135, 214], [20, 135, 21], [242, 168, 271], [296, 262, 205], [305, 188, 293], [219, 183, 203], [268, 183, 203], [212, 167, 224], [205, 198, 153], [196, 176, 169], [318, 287, 196], [199, 163, 205], [241, 310, 103], [88, 115, 167], [175, 43, 296], [304, 196, 117], [65, 196, 117], [87, 115, 154], [15, 90, 91], [281, 330, 232], [220, 330, 232], [289, 190, 232], [118, 3, 288], [44, 92, 117], [77, 154, 117], [117, 154, 117], [245, 182, 227], [127, 145, 138], [260, 187, 231], [91, 126, 141], [21, 66, 107], [185, 131, 280], [165, 59, 253], [308, 204, 233], [189, 232, 122], [162, 247, 78], [209, 125, 188], [158, 141, 159], [84, 141, 134], [207, 220, 212], [109, 173, 104], [239, 63, 105], [3, 63, 105], [161, 186, 295], [175, 186, 295], [155, 186, 295], [292, 186, 295], [215, 186, 295], [205, 169, 205], [286, 154, 298], [276, 140, 296], [94, 163, 86], [155, 86, 231], [288, 163, 251], [295, 175, 173], [133, 175, 173], [138, 198, 105], [174, 46, 309], [249, 160, 265], [314, 162, 233], [69, 120, 121], [154, 145, 196], [254, 183, 237], [140, 154, 143], [259, 181, 243], [54, 196, 18], [60, 109, 115], [233, 160, 220], [150, 145, 172], [326, 212, 279], [113, 9, 271], [8, 186, 311], [306, 186, 239], [247, 171, 232], [269, 198, 253], [165, 181, 263], [278, 307, 263], [69, 114, 124], [135, 109, 217], [164, 194, 128], [196, 147, 221], [73, 68, 245], [6, 234, 165], [236, 234, 165], [183, 234, 165], [128, 141, 161], [97, 105, 159], [100, 96, 162], [87, 109, 161], [158, 126, 191], [98, 193, 107], [283, 208, 266], [199, 152, 206], [162, 53, 275], [195, 79, 188], [146, 154, 158], [8, 61, 111], [3, 0, 83], [220, 169, 214], [147, 156, 195], [251, 137, 285], [122, 172, 116], [181, 136, 198], [255, 192, 244], [318, 185, 297], [283, 191, 260], [228, 190, 208], [3, 75, 91], [327, 212, 287], [171, 218, 111], [59, 82, 134], [158, 120, 266], [262, 183, 253], [173, 167, 230], [134, 115, 182], [295, 194, 255], [270, 173, 263], [182, 107, 115], [3, 107, 115], [188, 160, 147], [142, 160, 147], [292, 160, 260], [136, 0, 92], [235, 175, 206], [44, 82, 132], [200, 169, 198], [319, 198, 266], [324, 198, 231], [233, 198, 231], [240, 152, 252], [313, 217, 272], [135, 115, 190], [255, 60, 207], [4, 60, 256], [174, 162, 186], [215, 94, 287], [120, 17, 271], [178, 210, 138], [327, 210, 281], [313, 247, 233], [134, 139, 157], [250, 194, 218], [10, 125, 144], [222, 215, 187], [100, 169, 96], [76, 136, 107], [133, 96, 74], [94, 323, 171], [295, 204, 255], [54, 198, 244], [262, 193, 241], [104, 204, 59], [257, 204, 59], [210, 208, 170], [183, 331, 20], [3, 185, 223], [172, 130, 215], [105, 81, 215], [152, 140, 171], [219, 162, 221], [133, 182, 329], [45, 110, 97], [237, 174, 230], [24, 115, 96], [210, 171, 206], [141, 112, 172], [314, 112, 276], [212, 112, 172], [136, 43, 300], [228, 196, 203], [283, 213, 265], [61, 246, 20], [31, 107, 86], [257, 198, 193], [167, 145, 189], [24, 103, 84], [125, 3, 289], [89, 3, 220], [75, 79, 163], [149, 141, 171], [310, 204, 171], [43, 204, 2], [159, 163, 205], [324, 176, 276], [270, 176, 276], [295, 197, 246], [309, 305, 167], [11, 305, 167], [220, 274, 113], [239, 212, 196], [219, 288, 102], [269, 192, 185], [47, 127, 216], [257, 127, 216], [111, 103, 175], [282, 188, 253], [172, 125, 210], [181, 128, 197], [202, 328, 69], [276, 220, 219], [126, 239, 56], [295, 188, 252], [102, 234, 29], [127, 301, 110], [210, 301, 110], [193, 125, 236], [115, 107, 173], [123, 127, 168], [305, 141, 234], [327, 141, 234], [145, 141, 171], [115, 124, 157], [241, 172, 239], [307, 281, 132], [70, 80, 163], [228, 180, 219], [17, 130, 61], [240, 173, 235], [183, 219, 178], [152, 133, 96], [172, 146, 195], [1, 146, 195], [180, 85, 263], [223, 244, 93], [324, 294, 188], [167, 139, 198], [293, 214, 241], [227, 184, 227], [200, 184, 227], [34, 26, 174], [301, 297, 170], [271, 184, 274], [148, 140, 182], [313, 102, 238], [313, 218, 183], [124, 109, 183], [28, 25, 162], [80, 25, 162], [250, 25, 162], [114, 25, 256], [78, 127, 134], [144, 154, 147], [146, 138, 171], [235, 288, 113], [85, 146, 103], [270, 186, 250], [39, 110, 105], [307, 204, 287], [181, 221, 131], [326, 204, 284], [212, 204, 284], [139, 280, 23], [136, 218, 189], [310, 206, 272], [89, 82, 190], [209, 179, 185], [186, 179, 185], [158, 224, 209], [1, 224, 209], [271, 224, 209], [65, 135, 217], [166, 188, 183], [152, 178, 140], [314, 266, 207], [67, 266, 133], [259, 143, 245], [327, 197, 309], [255, 182, 224], [315, 152, 263], [134, 28, 273], [146, 146, 167], [250, 160, 266], [117, 137, 181], [237, 169, 236], [78, 91, 152], [144, 124, 191], [278, 182, 255], [126, 164, 128], [105, 124, 147], [196, 160, 203], [278, 224, 259], [309, 192, 284], [239, 144, 217], [205, 180, 198], [303, 228, 241], [257, 215, 284], [106, 215, 83], [198, 253, 118], [219, 160, 118], [301, 160, 118], [307, 178, 303], [190, 115, 239], [123, 297, 107], [223, 181, 203], [317, 217, 153], [75, 251, 83], [3, 163, 9], [321, 206, 86], [37, 128, 74], [45, 121, 280], [318, 121, 280], [134, 131, 168], [147, 143, 168], [283, 178, 238], [327, 195, 277], [162, 329, 186], [224, 175, 215]]
    lw_beam = [[327, 203, 279], [166, 181, 203], [148, 181, 203], [102, 128, 153], [136, 181, 124], [149, 79, 253], [309, 208, 265], [166, 278, 96], [51, 104, 110], [8, 24, 167], [163, 160, 170], [180, 120, 230], [43, 91, 117], [74, 68, 162], [219, 179, 207], [60, 120, 110], [262, 216, 211], [80, 115, 140], [115, 151, 128], [185, 96, 239], [309, 208, 150], [75, 92, 150], [88, 154, 132], [144, 151, 168], [49, 151, 26], [309, 151, 26], [216, 131, 250], [281, 194, 254], [327, 163, 0], [94, 163, 96], [69, 96, 129], [224, 171, 220], [322, 212, 278], [233, 35, 300], [295, 243, 195], [270, 190, 252], [199, 163, 244], [18, 228, 9], [271, 228, 9], [251, 197, 221], [292, 198, 221], [209, 167, 223], [228, 156, 153], [10, 22, 153], [220, 173, 216], [136, 182, 188], [195, 182, 188], [186, 160, 219], [255, 160, 219], [238, 168, 225], [133, 146, 190], [91, 188, 167], [283, 188, 167], [183, 188, 256], [133, 140, 107], [224, 172, 230], [111, 193, 107], [178, 140, 107], [171, 46, 290], [144, 35, 274], [104, 157, 153], [143, 157, 153], [249, 172, 244], [166, 0, 330], [212, 208, 205], [327, 214, 279], [68, 124, 231], [327, 191, 285], [145, 210, 252], [314, 210, 252], [19, 53, 132], [134, 103, 187], [327, 212, 278], [194, 168, 204], [160, 140, 186], [280, 208, 271], [289, 195, 301], [324, 218, 236], [295, 204, 263], [327, 214, 280], [83, 128, 139], [326, 196, 295], [261, 157, 208], [133, 206, 120], [108, 206, 120], [211, 68, 318], [233, 173, 226], [147, 115, 197], [249, 112, 218], [69, 112, 123], [205, 127, 203], [327, 127, 203], [314, 160, 329], [59, 160, 96], [19, 53, 132], [111, 283, 1], [149, 216, 103], [22, 137, 142], [126, 137, 142], [158, 110, 214], [251, 223, 114], [235, 178, 225], [158, 57, 266], [44, 151, 102], [180, 170, 203], [171, 46, 163], [303, 191, 248], [102, 140, 119], [173, 136, 206], [183, 151, 192], [32, 176, 26], [123, 119, 196], [134, 53, 117], [76, 107, 127], [111, 154, 142], [49, 112, 108], [292, 195, 260], [171, 191, 83], [197, 168, 197], [58, 195, 29], [313, 195, 265], [228, 195, 182], [327, 6, 177], [120, 206, 154], [288, 206, 248], [327, 210, 283], [242, 185, 157], [165, 169, 157], [262, 215, 259], [327, 212, 283], [282, 169, 279], [228, 178, 219], [164, 210, 132], [147, 314, 159], [268, 177, 238], [312, 0, 157], [154, 0, 157], [135, 137, 163], [173, 137, 163], [269, 196, 230], [257, 204, 124], [144, 147, 142], [180, 194, 124], [283, 194, 115], [233, 130, 298], [327, 210, 260], [218, 180, 203], [49, 106, 131], [309, 187, 276], [280, 197, 246], [182, 134, 215], [327, 221, 286], [217, 150, 228], [304, 212, 288], [34, 108, 109], [185, 176, 180], [79, 120, 126], [306, 140, 206], [211, 249, 206], [89, 127, 129], [216, 294, 59], [67, 226, 13], [233, 266, 113], [86, 184, 158], [280, 177, 254], [221, 218, 170], [259, 218, 170], [26, 178, 9], [240, 178, 9], [276, 178, 259], [157, 154, 192], [313, 187, 295], [327, 216, 279], [301, 191, 278], [141, 174, 177], [180, 140, 177], [53, 60, 150], [86, 124, 178], [182, 167, 178], [97, 78, 186], [72, 151, 144], [171, 220, 142], [321, 220, 266], [181, 198, 150], [136, 198, 150], [219, 180, 217], [155, 126, 125], [269, 189, 257], [209, 190, 208], [268, 190, 240], [292, 232, 259], [195, 146, 221], [327, 237, 255], [115, 6, 259], [195, 131, 240], [327, 210, 281], [156, 222, 103], [172, 126, 234], [120, 171, 193], [257, 171, 253], [261, 234, 228], [185, 181, 170], [13, 75, 102], [147, 178, 209], [202, 300, 96], [166, 151, 197], [79, 119, 132], [259, 96, 330], [176, 141, 294], [270, 141, 294], [49, 214, 1], [301, 221, 216], [159, 322, 12], [313, 210, 272], [195, 136, 215], [216, 187, 196], [5, 89, 78], [240, 180, 227], [121, 160, 125], [292, 178, 280], [283, 197, 253], [87, 188, 66], [3, 172, 35], [136, 172, 35], [243, 293, 117], [71, 78, 115], [225, 170, 228], [114, 96, 186], [3, 167, 0], [61, 6, 223], [244, 181, 230], [225, 96, 289], [283, 175, 20], [27, 175, 20], [167, 128, 220], [324, 218, 274], [261, 151, 276], [261, 179, 172], [171, 179, 172], [233, 236, 168], [319, 220, 266], [308, 195, 266], [141, 68, 255], [221, 83, 218], [13, 83, 89], [212, 124, 255], [293, 252, 197], [327, 198, 285], [245, 197, 230], [283, 197, 230], [218, 181, 204], [253, 188, 232], [136, 151, 150], [327, 289, 206], [176, 114, 208], [301, 212, 256], [134, 128, 157], [190, 20, 324], [311, 192, 113], [76, 192, 113], [4, 83, 109], [127, 132, 138], [250, 212, 264], [81, 212, 264], [307, 184, 264], [160, 90, 233], [46, 90, 83], [72, 168, 183], [174, 168, 183], [250, 151, 290], [233, 169, 224], [181, 151, 208], [19, 63, 105], [3, 88, 121], [178, 146, 273], [179, 75, 244], [322, 210, 279], [121, 141, 138], [271, 266, 187], [228, 172, 221], [171, 151, 186], [89, 151, 142], [162, 275, 181], [60, 197, 23], [205, 112, 120], [73, 112, 120], [125, 198, 315], [172, 198, 315], [158, 198, 315], [306, 198, 315], [225, 198, 315], [143, 128, 181], [327, 179, 316], [313, 212, 280], [3, 160, 48], [150, 115, 186], [307, 185, 233], [305, 171, 176], [107, 171, 176], [164, 136, 193], [225, 62, 330], [261, 182, 251], [255, 176, 228], [71, 115, 136], [162, 136, 177], [209, 177, 183], [128, 124, 169], [280, 191, 260], [60, 190, 21], [3, 68, 102], [243, 176, 220], [137, 162, 142], [251, 163, 255], [126, 2, 290], [21, 208, 318], [305, 208, 263], [242, 188, 205], [224, 120, 273], [205, 160, 285], [310, 330, 285], [43, 130, 89], [151, 94, 212], [68, 218, 18], [271, 193, 242], [159, 178, 253], [35, 329, 128], [289, 329, 128], [174, 329, 128], [116, 130, 149], [211, 162, 203], [36, 60, 142], [116, 114, 168], [216, 172, 208], [24, 185, 35], [237, 169, 236], [237, 175, 227], [91, 4, 256], [283, 220, 198], [134, 108, 192], [18, 94, 89], [39, 0, 114], [225, 172, 218], [65, 78, 153], [327, 216, 276], [167, 168, 185], [88, 79, 189], [257, 181, 253], [273, 162, 278], [296, 210, 254], [155, 145, 159], [17, 92, 80], [309, 182, 295], [97, 180, 83], [3, 103, 96], [175, 74, 296], [257, 177, 258], [276, 167, 224], [42, 103, 142], [327, 218, 277], [309, 206, 272], [233, 154, 169], [46, 154, 169], [181, 142, 187], [135, 142, 187], [273, 142, 240], [174, 0, 130], [214, 170, 211], [56, 79, 154], [102, 91, 179], [178, 179, 206], [278, 184, 232], [219, 184, 232], [114, 1, 278], [317, 204, 279], [179, 146, 185], [222, 97, 238], [16, 97, 246], [198, 188, 170], [180, 297, 50], [205, 228, 107], [216, 156, 138], [249, 156, 259], [327, 250, 239], [75, 130, 124], [287, 219, 244], [3, 38, 128], [255, 271, 147], [34, 79, 131], [98, 126, 138], [28, 96, 97], [47, 318, 104], [269, 173, 263], [108, 174, 248], [259, 180, 247], [243, 168, 276], [292, 168, 276], [219, 193, 189], [73, 204, 29], [327, 212, 283], [185, 137, 215], [75, 20, 215], [79, 122, 123], [199, 156, 194], [165, 247, 293], [28, 128, 66], [251, 185, 244], [3, 105, 66], [233, 185, 204], [127, 128, 157], [327, 128, 283], [205, 128, 157], [251, 190, 198], [251, 192, 232], [327, 212, 281], [102, 242, 50], [120, 132, 154], [251, 187, 233], [140, 163, 167], [198, 163, 198], [178, 40, 281], [87, 40, 211], [65, 7, 218], [133, 167, 247], [262, 213, 247], [159, 272, 37], [242, 183, 225], [310, 169, 248], [245, 169, 248], [295, 206, 234], [313, 252, 238], [3, 252, 238], [228, 304, 102], [283, 160, 254], [283, 330, 120], [280, 197, 194], [49, 107, 211], [257, 107, 211], [212, 156, 250], [276, 181, 237], [193, 162, 198], [101, 122, 142], [195, 306, 57], [295, 232, 226], [261, 181, 246], [292, 198, 254], [87, 251, 9], [172, 328, 239], [202, 328, 239], [178, 123, 237], [101, 83, 183], [125, 127, 142], [308, 91, 252], [310, 91, 252], [85, 91, 159], [151, 145, 172], [327, 216, 279], [205, 258, 114], [49, 29, 167], [183, 162, 188], [111, 128, 150], [278, 192, 253], [198, 212, 162], [120, 62, 138], [117, 146, 172], [12, 146, 172], [309, 188, 266], [223, 249, 117], [242, 256, 147], [223, 172, 217], [281, 208, 239], [251, 160, 203], [149, 160, 203], [3, 7, 162], [292, 313, 147], [254, 145, 278], [135, 140, 172], [84, 112, 238], [295, 224, 168], [182, 181, 168], [68, 29, 153], [111, 29, 153], [257, 29, 153], [126, 29, 255], [97, 125, 160], [120, 115, 169], [86, 96, 158], [240, 290, 117], [67, 107, 150], [303, 198, 278], [13, 89, 90], [327, 208, 284], [171, 217, 128], [233, 145, 218], [181, 145, 218], [133, 208, 83], [317, 328, 180], [237, 178, 225], [65, 115, 113], [186, 145, 97], [80, 145, 97], [166, 322, 132], [76, 322, 132], [283, 322, 132], [76, 149, 216], [175, 192, 168], [167, 151, 183], [314, 238, 241], [73, 238, 139], [283, 207, 238], [262, 154, 287], [223, 192, 214], [278, 168, 285], [118, 1, 284], [223, 187, 198], [327, 198, 288], [89, 70, 186], [228, 156, 240], [54, 96, 121], [171, 161, 181], [274, 169, 283], [155, 151, 171], [148, 151, 171], [216, 172, 208], [308, 204, 262], [271, 179, 242], [262, 186, 216], [317, 206, 246], [327, 240, 249], [268, 257, 307], [94, 257, 9], [171, 173, 177], [241, 57, 177], [114, 57, 177], [326, 198, 294], [183, 21, 325], [167, 329, 147], [216, 159, 214], [301, 206, 228], [97, 260, 125], [72, 185, 44], [138, 247, 59], [136, 156, 147], [37, 126, 277], [273, 126, 277], [155, 145, 178], [186, 156, 196], [268, 245, 190], [301, 182, 287], [186, 330, 198], [193, 125, 235]]
    subevent_beam = [1.0, 2.0, 2.1, 5.0, 7.0, 7.1, 9.1, 10.0, 12.0, 13.0, 16.1, 19.0, 21.0, 22.0, 28.0, 28.1, 29.0, 30.0, 34.0, 36.5, 42.0, 42.1, 48.0, 49.0, 49.1, 49.2, 49.3, 51.1, 52.0, 52.1, 54.0, 54.1, 55.0, 57.0, 58.0, 63.0, 65.2, 65.3, 65.4, 67.1, 67.2, 68.0, 69.0, 69.1, 75.0, 76.0, 76.1, 77.0, 77.1, 80.0, 81.0, 83.0, 83.1, 84.0, 84.1, 84.2, 84.3, 84.4, 88.0, 88.1, 89.0, 89.1, 90.0, 92.0, 99.1, 100.0, 101.0, 103.0, 111.0, 111.1, 112.0, 117.0, 120.0, 121.0, 128.0, 128.1, 136.0, 136.1, 138.0, 139.0, 143.0, 144.0, 145.0, 147.1, 147.2, 150.0, 152.1, 154.0, 156.0, 156.1, 158.0, 158.1, 162.0, 162.1, 165.0, 166.0, 167.0, 167.1, 167.2, 167.3, 168.0, 169.0, 170.0, 173.0, 176.0, 178.1, 183.0, 185.0, 187.0, 192.0, 194.0, 198.0, 199.0, 200.0, 206.1, 211.0, 213.1, 215.1, 215.2, 215.3, 215.4, 215.5, 221.0, 225.0, 225.1, 226.0, 227.0, 227.1, 229.0, 230.1, 230.2, 233.0, 238.0, 243.0, 244.0, 248.0, 248.1, 249.1, 249.2, 250.0, 251.0, 254.0, 254.1, 254.2, 254.3, 255.0, 257.5, 257.6, 260.0, 260.1, 262.0, 265.0, 265.1, 265.2, 265.3, 266.0, 266.1, 266.2, 266.3, 268.0, 270.0, 274.0, 280.0, 282.0, 282.1, 283.0, 283.1, 285.0, 285.1, 286.0, 286.1, 288.0, 291.1, 293.0, 296.1, 296.2, 299.0, 302.0, 302.1, 305.0, 308.1, 308.2, 308.3, 310.0, 310.1, 311.1, 315.0, 316.0, 321.0, 321.1, 325.0, 330.0, 331.0, 331.1, 335.0, 340.0, 342.0, 343.0, 344.1, 344.2, 348.0, 350.0, 352.0, 360.0, 364.1, 371.0, 379.2, 379.3, 379.4, 379.5, 380.1, 381.0, 382.1, 382.2, 383.0, 385.0, 392.0, 392.1, 394.0, 394.1, 395.0, 399.1, 402.0, 402.1, 403.1, 405.0, 409.0, 409.1, 413.0, 415.0, 418.0, 419.0, 419.1, 419.2, 421.1, 421.2, 424.0, 429.0, 429.1, 434.0, 434.1, 440.0, 441.0, 441.1, 441.2, 443.0, 444.0, 446.1, 449.0, 449.1, 450.0, 450.1, 451.0, 454.0, 460.1, 463.0, 463.1, 465.1, 467.0, 467.1, 468.0, 469.1, 470.0, 470.1, 470.2, 477.0, 478.0, 478.1, 478.2, 481.0, 483.1, 484.0, 488.0, 492.0, 493.2, 495.0, 496.0, 496.1, 497.0, 500.0, 504.0, 504.1, 508.0, 510.0, 511.0, 511.1, 519.0, 519.1, 519.2, 519.3, 519.4, 520.0, 520.1, 522.1, 523.1, 523.2, 525.0, 525.1, 525.2, 525.3, 526.0, 527.0, 530.1, 531.0, 533.0, 534.2, 534.3, 534.4, 537.0, 540.0, 541.1, 541.2, 543.0, 544.0, 544.1, 544.2, 547.0, 547.1, 556.0, 556.1, 558.1, 560.0, 561.0, 569.0, 570.0, 571.0, 571.1, 571.2, 573.0, 577.0, 577.1, 580.0, 581.0, 582.0, 584.0, 586.0, 596.0, 597.2, 598.0, 598.1, 599.0, 601.0, 603.0, 604.0, 606.0, 608.0, 611.0, 617.0, 618.0, 624.0, 626.1, 632.0, 633.0, 635.1, 637.0, 645.1, 647.0, 647.1, 649.0, 650.0, 650.1, 650.2, 652.0, 652.1, 652.2, 660.0, 661.0, 662.0, 662.1, 664.0, 667.0, 667.1, 668.0, 668.1, 668.2, 672.2, 672.3, 675.1, 677.0, 678.0, 683.1, 683.2, 683.3, 684.0, 684.1, 685.0, 685.1, 688.0, 690.0, 693.0, 694.0, 695.0, 696.1, 696.2, 697.0, 697.1, 700.1, 701.1, 702.0, 709.0, 709.1, 714.0, 715.0, 715.1, 717.0, 718.0, 719.0, 719.1, 721.0, 721.1, 721.2, 723.0, 725.0, 726.1, 728.1, 730.0, 730.1, 733.1, 735.0, 736.5, 736.6, 737.0, 737.1, 737.2, 741.0, 745.0, 750.0, 750.1, 756.0, 758.2, 758.3, 759.0, 760.0, 761.0, 762.0, 766.0, 766.1, 769.0, 770.0, 770.1, 772.1, 778.0, 781.3, 783.0, 785.0, 786.0, 790.0, 790.1, 792.0, 794.0, 800.1, 801.0, 801.1, 801.2, 803.0, 805.0, 809.0, 812.0, 813.0, 816.0, 817.0, 821.0, 822.1, 822.2, 822.3, 824.0, 826.1, 826.2, 828.0, 830.0, 831.0, 831.1, 834.0, 837.0, 837.1, 839.1, 843.0, 850.0, 850.1, 850.2, 850.3, 850.4, 850.5, 851.1, 854.0, 860.0, 861.0, 862.1, 864.1, 868.0, 868.1, 872.0, 875.1, 875.2, 878.0, 880.0, 880.1, 893.0, 895.0, 895.1, 896.0, 896.1, 896.2, 897.0, 897.1, 900.0, 900.1, 900.2, 902.0, 905.0, 908.0, 909.1, 910.0, 910.1, 919.0, 922.0, 924.2, 925.0, 928.2, 928.3, 935.0, 936.0, 937.1, 940.1, 941.0, 941.1, 942.1, 943.0, 944.0, 944.1, 946.0, 946.1, 946.2, 947.1, 947.2, 955.0, 956.0, 957.0, 958.0, 959.0, 959.1, 966.0, 969.0, 969.1, 969.2, 977.1, 981.0, 985.0, 989.0, 992.0]
    
    ew_cosmics = [[46, 188, 21], [245, 183, 235], [125, 5, 287], [294, 232, 228], [85, 133, 246], [167, 208, 130], [163, 208, 220], [58, 208, 220], [153, 210, 134], [159, 151, 175], [150, 120, 198], [253, 241, 179], [71, 186, 208], [185, 317, 37], [145, 62, 248], [36, 68, 134], [250, 281, 136], [199, 180, 183], [268, 188, 247], [141, 293, 9], [228, 68, 329], [136, 300, 314], [136, 300, 314], [111, 300, 314], [77, 300, 314], [4, 300, 314], [284, 240, 209], [250, 276, 138], [250, 277, 179], [255, 312, 107], [83, 74, 195], [158, 114, 216], [171, 35, 0], [303, 163, 306], [329, 323, 176], [306, 281, 191], [205, 254, 104], [177, 254, 97], [198, 0, 232], [257, 327, 96], [19, 103, 78], [317, 124, 323], [235, 127, 228], [189, 127, 228], [276, 156, 288], [188, 37, 326], [262, 239, 189], [171, 66, 266], [224, 80, 313], [139, 198, 96], [17, 169, 2], [323, 156, 163], [326, 328, 163], [29, 86, 121], [61, 208, 96], [199, 115, 254], [219, 204, 205], [292, 210, 238], [180, 298, 44], [133, 195, 254], [70, 195, 254], [84, 179, 59], [35, 125, 171], [228, 146, 252], [331, 329, 134], [61, 53, 177], [86, 220, 96], [136, 35, 265], [107, 148, 107], [251, 290, 144], [153, 167, 290], [179, 96, 248], [190, 188, 169], [86, 10, 245], [209, 272, 105], [126, 29, 302], [167, 29, 302], [139, 79, 225], [128, 86, 208], [209, 131, 230], [199, 160, 203], [309, 184, 291], [301, 319, 153], [191, 230, 128], [235, 68, 324], [29, 96, 96], [235, 162, 240], [97, 186, 74], [288, 208, 247], [39, 80, 123], [186, 74, 279], [209, 210, 168], [45, 136, 0], [127, 24, 273], [163, 22, 302], [116, 112, 170], [4, 0, 96], [69, 186, 142], [46, 186, 142], [84, 186, 142], [42, 186, 142], [200, 82, 284], [165, 167, 158], [179, 284, 44], [126, 91, 86], [134, 178, 120], [151, 198, 117], [327, 292, 203], [227, 283, 110], [240, 278, 134], [178, 328, 29], [31, 180, 219], [320, 180, 219], [167, 318, 39], [3, 124, 67], [177, 287, 59], [287, 173, 281], [166, 167, 168], [327, 271, 219], [197, 112, 236], [79, 137, 179], [108, 120, 150], [44, 133, 74], [88, 156, 97], [133, 1, 280], [261, 253, 178], [212, 169, 128], [295, 210, 253], [205, 91, 302], [317, 181, 294], [138, 83, 211], [257, 300, 124], [93, 145, 113], [161, 115, 209], [122, 29, 250], [82, 60, 93], [43, 206, 29], [50, 89, 122], [26, 89, 96], [97, 208, 205], [295, 251, 193], [98, 57, 198], [42, 74, 134], [99, 242, 21], [163, 204, 125], [100, 299, 125], [193, 60, 299], [282, 295, 157], [193, 36, 320], [219, 96, 309], [329, 197, 274], [114, 168, 111], [326, 198, 256], [225, 272, 119], [219, 190, 196], [178, 224, 123], [173, 103, 318], [167, 103, 318], [245, 204, 221], [120, 260, 1], [1, 39, 86], [195, 256, 110], [281, 137, 328], [188, 102, 255], [141, 234, 226], [301, 187, 283], [246, 151, 264], [158, 234, 86], [329, 156, 205], [186, 152, 203], [124, 141, 138], [278, 162, 289], [254, 286, 138], [82, 220, 29], [269, 322, 111], [228, 322, 111], [176, 246, 130], [314, 246, 231], [269, 151, 287], [303, 328, 142], [314, 167, 303], [216, 74, 313], [27, 131, 74], [145, 46, 260], [327, 300, 186], [188, 192, 162], [3, 110, 53], [118, 215, 96], [264, 110, 316], [188, 204, 167], [262, 272, 162], [314, 228, 255], [13, 40, 143], [137, 286, 40], [163, 286, 40], [114, 277, 1], [155, 179, 159], [195, 46, 294], [164, 107, 298], [76, 5, 298], [134, 277, 1], [196, 325, 35], [171, 151, 196], [14, 151, 196], [146, 34, 102], [195, 35, 328], [112, 162, 121], [171, 1, 331], [99, 38, 236], [237, 219, 176], [296, 276, 186], [276, 163, 275], [159, 130, 195], [165, 82, 251], [147, 257, 53], [55, 107, 113], [65, 107, 113], [65, 37, 190], [233, 151, 251], [133, 0, 119], [121, 275, 14], [259, 241, 187], [198, 115, 316], [173, 115, 114], [1, 29, 134], [97, 167, 0], [147, 310, 1], [67, 66, 158], [42, 66, 158], [166, 291, 37], [225, 109, 283], [177, 140, 0], [310, 224, 252], [330, 281, 216], [233, 187, 210], [59, 40, 185], [26, 174, 18], [157, 86, 236], [202, 114, 256], [235, 222, 183], [166, 61, 281], [128, 108, 182], [180, 180, 188], [218, 194, 188], [276, 222, 220], [91, 12, 236], [281, 182, 266], [159, 218, 105], [55, 141, 96], [42, 35, 204], [3, 145, 252], [59, 114, 109], [103, 96, 173], [210, 247, 0], [326, 306, 91], [250, 229, 178], [237, 78, 328], [134, 180, 119], [185, 141, 211], [327, 224, 271], [314, 280, 198], [0, 79, 148], [163, 108, 221], [150, 38, 276], [152, 103, 172], [83, 110, 138], [75, 12, 239], [321, 173, 320], [273, 112, 329], [269, 141, 273], [78, 141, 273], [329, 172, 324], [19, 167, 18], [65, 115, 122], [73, 57, 183], [193, 29, 329], [228, 322, 103], [19, 79, 103], [10, 66, 110], [24, 66, 110], [133, 35, 252], [247, 131, 203], [9, 57, 117], [12, 74, 103], [243, 299, 114], [259, 141, 281], [202, 256, 111], [303, 276, 225], [167, 108, 193], [188, 157, 195], [141, 208, 167], [167, 187, 168], [55, 128, 105], [171, 89, 249], [51, 72, 147], [215, 172, 204], [32, 44, 167], [81, 235, 9], [241, 253, 157], [235, 246, 154], [147, 14, 206], [125, 14, 206], [125, 14, 206], [327, 14, 206], [269, 271, 167], [123, 92, 197], [20, 162, 26], [24, 57, 240], [118, 190, 172], [191, 18, 172], [70, 60, 172], [183, 60, 172], [97, 61, 198], [289, 181, 265], [251, 235, 182], [105, 167, 111], [39, 2, 203], [257, 300, 126], [326, 220, 271], [198, 220, 271], [255, 192, 235], [51, 38, 169], [219, 38, 216], [202, 141, 226], [141, 274, 35], [97, 126, 131], [23, 176, 96], [303, 286, 183], [143, 187, 120], [197, 184, 171], [188, 184, 171], [95, 107, 158], [77, 114, 130], [239, 174, 231], [189, 172, 172], [221, 250, 138], [268, 266, 169], [240, 330, 96], [194, 66, 296], [180, 141, 171], [314, 154, 330], [219, 68, 318], [223, 145, 244], [189, 36, 314], [178, 316, 13], [327, 168, 319], [251, 124, 298], [1, 112, 55], [330, 198, 214], [261, 140, 293], [222, 169, 226], [133, 177, 121], [157, 6, 320], [27, 78, 117], [76, 63, 167], [65, 58, 174], [83, 97, 147], [74, 43, 198], [121, 236, 50], [317, 312, 170], [228, 283, 114], [327, 264, 230], [115, 120, 161], [167, 0, 320], [15, 104, 91], [211, 189, 188], [27, 90, 102], [103, 102, 168], [216, 174, 211], [112, 170, 110], [158, 63, 264], [249, 126, 297], [259, 287, 142], [93, 190, 74], [172, 163, 172], [83, 79, 171], [100, 3, 264], [294, 146, 314], [186, 13, 0], [50, 90, 126], [65, 43, 189], [321, 151, 329], [142, 26, 159], [48, 26, 214], [127, 257, 37], [85, 74, 172], [79, 167, 172], [82, 183, 59], [65, 141, 0], [250, 221, 183], [259, 190, 239], [143, 186, 236], [182, 224, 125], [295, 140, 124], [115, 140, 124], [312, 188, 289], [8, 34, 130], [6, 35, 130], [237, 248, 157], [142, 193, 122], [77, 97, 142], [144, 10, 302], [301, 34, 241], [165, 34, 241], [98, 57, 198], [225, 68, 327], [201, 42, 329], [1, 97, 74], [128, 0, 192], [72, 192, 48], [210, 51, 330], [37, 193, 1], [133, 297, 1], [142, 178, 0], [159, 197, 123], [200, 230, 138], [222, 96, 290], [75, 96, 290], [11, 130, 44], [111, 4, 276], [310, 289, 181], [97, 37, 236], [76, 18, 236], [327, 255, 244], [125, 277, 0], [30, 29, 167], [82, 29, 220], [240, 142, 309], [282, 289, 162], [128, 131, 154]]
    lw_cosmics = [[11, 109, 50], [235, 197, 206], [121, 5, 278], [235, 208, 205], [158, 104, 254], [158, 256, 96], [164, 188, 206], [61, 188, 206], [189, 241, 124], [205, 136, 250], [193, 156, 189], [262, 232, 207], [81, 156, 209], [180, 330, 18], [99, 3, 263], [3, 20, 138], [283, 328, 119], [212, 168, 232], [283, 257, 209], [174, 234, 66], [216, 109, 281], [140, 302, 324], [140, 302, 324], [282, 302, 324], [40, 302, 324], [2, 302, 324], [233, 160, 255], [262, 210, 240], [233, 240, 144], [262, 259, 170], [29, 86, 123], [177, 112, 193], [177, 37, 0], [222, 137, 245], [317, 262, 221], [321, 330, 161], [196, 241, 125], [183, 241, 104], [292, 0, 221], [280, 208, 242], [52, 37, 191], [289, 167, 304], [251, 146, 234], [212, 146, 234], [319, 178, 306], [201, 115, 205], [178, 212, 150], [133, 131, 161], [292, 198, 246], [140, 184, 114], [47, 187, 21], [235, 126, 174], [313, 291, 174], [74, 154, 103], [276, 291, 197], [195, 123, 249], [326, 258, 191], [306, 223, 247], [198, 319, 29], [97, 206, 207], [74, 206, 207], [91, 170, 83], [95, 156, 96], [193, 179, 179], [327, 286, 208], [47, 96, 120], [23, 78, 134], [108, 28, 247], [79, 140, 111], [247, 329, 108], [183, 154, 303], [158, 43, 288], [143, 141, 174], [94, 1, 259], [281, 327, 121], [77, 4, 315], [153, 4, 315], [3, 83, 96], [6, 43, 125], [225, 66, 312], [228, 74, 328], [171, 82, 138], [319, 330, 157], [205, 151, 225], [193, 120, 246], [3, 46, 121], [218, 145, 245], [65, 103, 138], [148, 276, 96], [3, 83, 96], [69, 17, 183], [195, 154, 209], [52, 131, 0], [71, 68, 185], [146, 1, 309], [91, 57, 195], [61, 0, 138], [71, 175, 172], [36, 175, 172], [89, 175, 172], [36, 175, 172], [238, 83, 311], [227, 204, 189], [173, 252, 77], [171, 327, 12], [50, 167, 115], [120, 181, 117], [262, 235, 221], [183, 230, 123], [171, 263, 97], [120, 285, 1], [15, 179, 212], [313, 179, 212], [171, 328, 9], [35, 146, 21], [154, 317, 9], [327, 220, 275], [327, 218, 276], [306, 258, 203], [178, 96, 248], [19, 151, 173], [3, 107, 96], [6, 163, 20], [5, 125, 66], [143, 28, 265], [221, 186, 205], [225, 167, 153], [259, 175, 240], [327, 168, 309], [324, 151, 325], [95, 92, 161], [326, 311, 169], [107, 74, 206], [125, 83, 198], [6, 18, 154], [59, 96, 120], [51, 198, 13], [100, 86, 178], [82, 86, 144], [313, 248, 213], [262, 263, 168], [122, 96, 179], [73, 120, 120], [6, 160, 21], [136, 168, 138], [103, 282, 138], [225, 82, 295], [188, 248, 107], [186, 35, 313], [259, 114, 322], [190, 302, 109], [16, 88, 102], [257, 163, 243], [73, 169, 96], [318, 196, 280], [245, 276, 134], [167, 137, 322], [163, 137, 322], [239, 226, 171], [138, 254, 21], [21, 182, 9], [163, 310, 23], [287, 137, 322], [295, 137, 327], [120, 282, 13], [182, 140, 206], [283, 206, 239], [118, 280, 12], [301, 151, 314], [172, 109, 237], [164, 136, 179], [261, 92, 328], [223, 271, 121], [35, 131, 50], [251, 275, 138], [193, 275, 138], [235, 302, 173], [327, 302, 203], [319, 192, 303], [227, 172, 248], [326, 186, 307], [227, 91, 300], [19, 115, 66], [160, 4, 323], [292, 281, 169], [160, 194, 130], [15, 176, 9], [55, 125, 122], [240, 78, 330], [171, 212, 122], [295, 329, 138], [308, 222, 250], [49, 35, 152], [69, 302, 10], [138, 302, 10], [128, 204, 74], [142, 169, 111], [3, 83, 96], [182, 137, 306], [71, 18, 306], [117, 260, 23], [251, 316, 86], [30, 162, 35], [3, 162, 35], [86, 39, 128], [127, 68, 263], [65, 127, 107], [314, 176, 311], [5, 90, 97], [245, 253, 169], [326, 308, 180], [316, 160, 327], [188, 131, 231], [179, 96, 245], [161, 298, 29], [61, 1, 236], [76, 1, 236], [151, 68, 251], [245, 198, 214], [111, 0, 97], [127, 255, 48], [326, 319, 176], [198, 128, 320], [180, 128, 103], [14, 17, 162], [47, 168, 0], [202, 244, 86], [86, 60, 196], [61, 60, 196], [171, 284, 50], [221, 60, 329], [150, 146, 0], [309, 235, 249], [314, 325, 138], [251, 131, 275], [39, 6, 206], [18, 125, 50], [193, 92, 255], [115, 103, 209], [243, 236, 180], [185, 68, 294], [140, 103, 203], [180, 196, 198], [228, 198, 198], [255, 208, 223], [96, 21, 140], [274, 204, 238], [87, 125, 134], [44, 92, 115], [111, 20, 252], [23, 152, 266], [4, 43, 126], [50, 81, 168], [210, 245, 0], [276, 275, 80], [243, 184, 198], [176, 53, 311], [195, 262, 103], [262, 290, 153], [307, 246, 226], [303, 299, 172], [12, 174, 169], [154, 185, 159], [245, 154, 273], [196, 141, 176], [205, 176, 205], [106, 22, 251], [314, 151, 328], [218, 181, 203], [239, 146, 203], [77, 146, 203], [301, 154, 314], [116, 188, 86], [75, 120, 121], [83, 78, 172], [118, 3, 266], [219, 305, 111], [28, 82, 111], [4, 46, 138], [24, 46, 138], [113, 62, 212], [262, 224, 217], [18, 4, 181], [61, 91, 117], [262, 303, 142], [254, 194, 225], [98, 244, 7], [182, 154, 260], [125, 18, 187], [148, 130, 195], [225, 239, 178], [154, 146, 173], [116, 127, 154], [88, 53, 196], [57, 107, 117], [178, 96, 256], [48, 46, 147], [175, 210, 86], [262, 293, 150], [181, 242, 121], [166, 310, 190], [43, 310, 190], [88, 310, 190], [43, 310, 190], [324, 317, 174], [153, 4, 315], [27, 177, 18], [24, 43, 217], [113, 194, 167], [183, 28, 167], [34, 28, 167], [172, 28, 167], [159, 130, 171], [216, 53, 328], [324, 259, 230], [85, 198, 96], [69, 60, 176], [241, 302, 96], [273, 206, 205], [152, 206, 205], [324, 246, 237], [59, 68, 167], [222, 68, 250], [172, 154, 185], [138, 198, 77], [121, 172, 114], [16, 3, 178], [313, 320, 172], [73, 162, 104], [138, 172, 181], [186, 172, 181], [99, 114, 153], [90, 234, 114], [216, 167, 226], [122, 145, 159], [159, 163, 177], [309, 329, 150], [205, 244, 132], [165, 91, 232], [196, 91, 159], [249, 136, 298], [282, 197, 247], [237, 170, 240], [161, 4, 325], [153, 259, 37], [227, 125, 272], [233, 131, 259], [24, 187, 1], [135, 125, 167], [237, 169, 227], [295, 188, 286], [21, 160, 35], [199, 29, 329], [28, 190, 39], [83, 4, 246], [82, 53, 178], [141, 74, 235], [126, 92, 190], [98, 260, 13], [308, 283, 195], [259, 324, 103], [305, 229, 208], [151, 137, 179], [125, 2, 293], [47, 127, 77], [146, 125, 159], [39, 63, 134], [117, 154, 123], [198, 168, 205], [110, 152, 122], [158, 63, 260], [235, 141, 251], [324, 330, 159], [56, 103, 131], [16, 29, 142], [128, 176, 107], [120, 86, 203], [289, 278, 150], [128, 28, 0], [117, 210, 96], [165, 172, 109], [321, 188, 300], [162, 39, 123], [29, 39, 212], [153, 318, 23], [79, 96, 134], [84, 162, 134], [34, 194, 13], [50, 210, 0], [249, 216, 191], [216, 252, 150], [144, 184, 257], [161, 257, 96], [287, 141, 97], [77, 141, 97], [318, 196, 285], [6, 68, 96], [1, 39, 96], [240, 241, 169], [133, 208, 103], [65, 57, 167], [158, 26, 294], [292, 39, 247], [171, 39, 247], [107, 80, 214], [225, 69, 321], [171, 80, 273], [60, 5, 205], [108, 0, 185], [117, 107, 180], [241, 83, 325], [88, 136, 78], [189, 330, 26], [167, 197, 0], [176, 192, 132], [171, 277, 96], [90, 74, 117], [43, 74, 117], [15, 127, 48], [173, 10, 329], [310, 296, 178], [98, 20, 219], [76, 24, 219], [257, 212, 208], [127, 275, 0], [39, 1, 198], [27, 109, 97], [220, 53, 330], [276, 291, 150], [31, 78, 107]]
    subevent_cosmics = [3.0, 7.2, 9.0, 11.0, 12.1, 14.0, 14.1, 14.2, 16.0, 16.2, 16.3, 17.0, 21.1, 22.1, 23.0, 26.0, 28.2, 30.1, 31.0, 33.0, 34.1, 36.0, 36.1, 36.2, 36.3, 36.4, 36.6, 37.0, 41.0, 44.0, 46.0, 50.0, 51.0, 59.0, 60.0, 61.0, 65.0, 65.1, 67.0, 74.0, 79.0, 83.2, 85.0, 85.1, 91.0, 99.0, 104.0, 113.0, 116.0, 117.1, 118.0, 125.0, 125.1, 126.0, 126.1, 131.0, 144.1, 146.0, 147.0, 148.0, 148.1, 151.0, 152.0, 154.1, 156.2, 162.2, 166.1, 168.1, 173.1, 177.0, 178.0, 187.1, 188.0, 192.1, 195.0, 199.1, 199.2, 202.0, 204.0, 206.0, 213.0, 213.2, 215.0, 216.0, 218.0, 220.0, 220.1, 230.0, 239.0, 242.0, 242.1, 243.1, 249.0, 252.0, 253.0, 256.0, 257.0, 257.1, 257.2, 257.3, 257.4, 259.0, 263.0, 265.4, 269.0, 272.0, 272.1, 276.0, 277.0, 279.0, 280.1, 287.0, 287.1, 289.0, 290.0, 291.0, 292.0, 296.0, 306.0, 307.0, 308.0, 311.0, 312.0, 336.0, 339.0, 339.1, 341.0, 343.1, 344.0, 344.3, 346.0, 347.0, 350.1, 350.2, 357.0, 358.0, 359.0, 361.0, 361.1, 364.0, 365.0, 370.0, 377.0, 378.0, 379.0, 379.1, 380.0, 381.1, 382.0, 384.0, 388.0, 390.0, 393.0, 399.0, 399.2, 400.0, 400.1, 400.2, 403.0, 412.0, 414.0, 419.3, 421.0, 428.0, 428.1, 430.0, 433.0, 440.1, 446.0, 447.0, 447.1, 448.0, 453.0, 456.0, 456.1, 456.2, 457.0, 457.1, 460.0, 461.0, 465.0, 466.0, 468.1, 469.0, 471.0, 472.0, 472.1, 474.0, 476.0, 476.1, 478.3, 480.0, 483.0, 487.0, 487.1, 488.1, 490.0, 492.1, 493.0, 493.1, 499.0, 502.0, 503.0, 503.1, 505.0, 506.0, 508.1, 514.0, 517.0, 518.0, 522.0, 523.0, 529.0, 530.0, 533.1, 534.0, 534.1, 541.0, 544.3, 546.0, 546.1, 548.0, 554.0, 554.1, 554.2, 558.0, 559.0, 560.1, 560.2, 562.0, 565.0, 566.0, 567.0, 568.0, 578.0, 580.1, 581.1, 583.0, 587.0, 590.0, 591.0, 593.0, 597.0, 597.1, 597.3, 600.0, 607.0, 607.1, 615.0, 620.0, 620.1, 620.2, 620.3, 623.0, 626.0, 628.0, 631.0, 634.0, 635.0, 635.2, 636.0, 636.1, 638.0, 639.0, 640.0, 641.0, 644.0, 645.0, 648.0, 651.0, 651.1, 667.2, 670.0, 671.0, 672.0, 672.1, 672.4, 672.5, 672.6, 672.7, 675.0, 676.0, 680.0, 682.0, 683.0, 687.0, 687.1, 691.0, 691.1, 693.1, 696.0, 698.0, 698.1, 700.0, 701.0, 703.0, 723.1, 725.1, 726.0, 728.0, 729.0, 729.1, 729.2, 729.3, 729.4, 733.0, 734.0, 736.0, 736.1, 736.2, 736.3, 736.4, 738.0, 738.1, 740.0, 740.1, 741.1, 741.2, 747.0, 747.1, 748.0, 758.0, 758.1, 762.1, 769.1, 772.0, 773.0, 778.1, 781.0, 781.1, 781.2, 783.1, 783.2, 783.3, 791.0, 795.0, 797.0, 799.0, 800.0, 801.3, 802.0, 805.1, 815.0, 817.1, 818.0, 819.0, 819.1, 822.0, 823.0, 826.0, 826.3, 832.0, 839.0, 841.0, 841.1, 843.1, 844.0, 844.1, 846.0, 847.0, 849.0, 851.0, 853.0, 855.0, 857.0, 862.0, 863.0, 864.0, 867.0, 869.0, 870.0, 872.1, 875.0, 875.3, 876.0, 879.0, 881.0, 884.0, 885.0, 893.1, 900.3, 904.0, 906.0, 906.1, 906.2, 907.0, 907.1, 909.0, 915.0, 917.0, 919.1, 920.0, 921.0, 924.0, 924.1, 926.0, 928.0, 928.1, 929.0, 929.1, 932.0, 937.0, 939.0, 939.1, 940.0, 942.0, 943.1, 943.2, 945.0, 945.1, 947.0, 947.3, 951.0, 953.0, 956.1, 957.1, 958.1, 958.2, 960.0, 960.1, 961.0, 962.0, 962.1, 962.2, 974.0, 977.0, 981.1, 986.0, 987.0, 991.0]

###############################################################################
# run
###############################################################################

ans1 = wiresMain(ew_beam,lw_beam,subevent_beam,'plot_beam_wires_')
ans2 = wiresMain(ew_cosmics,lw_cosmics,subevent_cosmics,'plot_cosmics_wires_')




